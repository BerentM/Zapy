{% extends "base.html" %}
{% import 'bootstrap/utils.html' as utils %}
{% block title %}
Dynamiczna tabela
{% endblock title %}

{% block page_content %}
</div>
    <main role="main" class="container" style="margin-top:150px;">
    	<div style="margin-top:20px;">
    		<h2>Przyk≈Çadowa tabela dynamiczna</h2>
    		<button id="dynTab-new-row-button" class="btn btn-dark">New Row</button>
		  	<table class="table table-striped table-bordered" id="dynTab">
			  	<thead class="thead-dark">
				    <tr>
				      <th scope="col">#</th>
				      <th scope="col">First</th>
				      <th scope="col">Last</th>
				      <th scope="col">Handle</th>
				    </tr>
			  	</thead>
			  	<tbody>
				    <tr>
				      <td>1</th>
				      <td>Mark</td>
				      <td>Otto</td>
				      <td>@mdo</td>
				    </tr>
				    <tr>
				      <td>2</th>
				      <td>Jacob</td>
				      <td>Thornton</td>
				      <td>@fat</td>
				    </tr>
				    <tr>
				      <td>3</th>
				      <td>Larry</td>
				      <td>the Bird</td>
				      <td>@twitter</td>
				    </tr>
			  	</tbody>
			</table>
		</div>
    </main>
</div>
{% endblock page_content %}

{% block scripts %}
{{ super() }}
    <script type='text/javascript' src="{{ url_for('static', filename='bstable.js') }}"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"></head>

	<script>
		// Example with a add new row button & only some columns editable & removed actions column label
		var dynamicTable = new BSTable("dynTab", {
			editableColumns:"1,2,3",
			$addButton: $('#dynTab-new-row-button'),
			onEdit:function(rowElement) {
				let item = $(rowElement).find('td').text();
				const postContent = $(rowElement).map(function(i, row) {
					const data = $('td', row);
					return {
						Id: data.eq(0).text().trim(),
						First: data.eq(1).text().trim(),
						Last: data.eq(2).text().trim(),
						Handle: data.eq(3).text().trim()
					}
					}).get();
				console.log(postContent);
				$.ajax({
					type: "POST",
					url: "/postmethod",
					contentType: "application/json",
					data: JSON.stringify({
						dane: postContent
					}),
					dataType: "json",
					success: function (response) {
						console.log(response);
					},
					error: function (err) {
						console.log(err);
					}
				});
			},
			advanced: {
				columnLabel: 'Actions'
			}
		});
		dynamicTable.init();
	</script>
{% endblock scripts %}